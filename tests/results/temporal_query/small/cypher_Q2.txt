MATCH (device:Sensor)-[:hasCoverage]-(environment:Infrastructure),(device)-[:hasTemperature]-(temp:Temperature) TT FROM 0 TO 2727510 RETURN environment, device, AVG(temp.temperature);